<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title><%= title %></title>

  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/sindresorhus/github-markdown-css@master/github-markdown.css" />
  <link rel="stylesheet" href="<%= root %>/resource/common.css" />
  <link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@latest/styles/default.min.css" />
  <script src="//unpkg.com/@highlightjs/cdn-assets@latest/highlight.min.js"></script>

  <link rel="manifest" href="<%= root %>/manifest.json" />
  <link rel="shortcut icon" type="image/x-icon" href="<%= favicon %>" />
  <link rel="bookmark" type="image/x-icon" href="<%= favicon %>" />
  <link rel="apple-touch-icon" href="<%= favicon %>" />

  <script>
    hljs.highlightAll();
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', async function () {
      // gen menu
      await (async function () {
        const menu = document.getElementById('menu');
        const data = await fetch('<%= root %>/dir_tree.json').then((res) => res.json());

        const insertMenuHtmlByFileInfoArr = (fileInfoArr = [], ele) => {
          if (!ele) {
            return;
          }

          fileInfoArr.forEach((info) => {
            const isDir = !!info.dirname;

            if (isDir) {
              const parentTextEle = document.createElement('span');
              parentTextEle.innerText = info.dirname;

              const parentEle = document.createElement('div');
              parentEle.className = 'parent expand';
              parentEle.id = info.id;
              parentTextEle.addEventListener('click', function () {
                parentEle.classList.toggle('expand')
              });

              parentEle.appendChild(parentTextEle);
              ele.appendChild(parentEle);

              insertMenuHtmlByFileInfoArr(info.children, parentEle);
            } else {
              const childrenEle = document.createElement('a');
              childrenEle.className = 'children';
              childrenEle.innerText = info.basename;
              childrenEle.id = info.id;
              childrenEle.href = `<%= root %>${info.relative_path ? '\\' + info.relative_path : ''}\\${
                info.basename
              }.html`;

              ele.appendChild(childrenEle);
            }
          });
        };

        insertMenuHtmlByFileInfoArr(data, menu);
      })();
    });
  </script>
</head>
